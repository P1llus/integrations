http_method: GET
http_headers: {"Content-Type": "application/json"}
interval: {{interval}}
json_objects_array: value
split_events_by: alerts..entities
url: {{url}}
oauth2.client.id: {{oauth2_client_id}}
oauth2.client.secret: {{oauth2_client_secret}}
oauth2.token_url: {{oauth2_client_secret}}
oauth2.provider: azure
oauth2.azure.resource: https://api.security.microsoft.com
http_headers: {{http_headers}}
date_cursor.field: lastUpdateTime
date_cursor.url_field: '$filter'
date_cursor.value_template: {{date_cursor.value_template}}
date_cursor.initial_interval: 55m
date_cursor.date_format: '2006-01-02T15:04:05.9999999Z'
tags: {{tags}}
{{#contains tags "forwarded"}}
publisher_pipeline.disable_host: true
{{/contains}}
processors:
  - decode_json_fields:
      fields: [message]
      target: json
  - add_fields:
      target: ''
      fields:
        ecs.version: 1.6.0